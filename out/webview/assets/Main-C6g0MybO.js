import{a as E,D as P,r as v,e as R,O as $,bq as q,v as n,f as r,af as J,k as b,ak as U,j as d,h as i,g as C,F as N,G as F,w as f,$ as p,M as x,n as _,L as S,t as w,av as H,q as I,aj as Q,br as z,y as G,o as a,H as K}from"./app-C_f3hKSw.js";import{_ as W}from"./vscode-MMfGApC2.js";import{u as X}from"./resultUIStore-AHBog-zL.js";import{b as h,D as V}from"./DatabaseType-BbdbLm9P.js";import"./wrapper-BXvM5gqA.js";import"./viewUtil-CTdDvppq.js";import"./_commonjsHelpers-CqkleIqs.js";import"./arrayUtil-BBqtGZ24.js";import"./objectUtil-Z6JRxuBJ.js";const Y={id:"tableTab",class:"tab"},Z=["onClick"],ee=E({__name:"Main",setup(te){const D=q(),y=X(),L=P(),l=v(null),g=v(!1),c=v("result"),u=v({}),m=v(!1),A=R(()=>[{id:"design",i18n:"table.design",icon:"codicon-edit",disabled:()=>!g.value},{id:"result",i18n:"table.data",icon:"codicon-database blue"},{id:"log",i18n:"common.log",icon:"codicon-file",hidden:()=>l.value==V.ES},{id:"erDiagram",i18n:"table.erDiagram",icon:"codicon-symbol-class yellow",hidden:()=>h(l.value),disabled:()=>!g.value||h(l.value)},{id:"status",i18n:"table.monitor",icon:"codicon-graph-line",disabled:()=>!y.monitorStatus.hasAnyMonitor,hidden:()=>h(l.value)},{id:"es-status",i18n:"table.monitor",icon:"codicon-graph-line",hidden:()=>l.value!=V.ES}].filter(t=>!t.hidden?.())),T=async()=>{if(!m.value){m.value=!0;try{await n.emit("pickDbSchema")}finally{m.value=!1}}},k=t=>{typeof t=="string"&&(t={id:t});const{id:e,disabled:s}=t;s?.()||c.value!==e&&(c.value=e,D.push(e),e=="log"&&n.emit("initTerminal"))};$(()=>{c.value=D.currentRoute.value.name,window.addEventListener("message",({data:t})=>{["RUN","DATA"].includes(t.type)&&(l.value=t.content.dbType,["design","result","erDiagram"].includes(c.value)||k("result"))}),n.on("table_info",({singleTable:t,dbType:e,monitorStatus:s})=>{l.value=e,g.value=t,Object.assign(y.monitorStatus,s),g.value||k("result")}).on("db_info",t=>{u.value=t||{}})});const M=()=>{n.emit("editInVSCode",y.toolbar.sql)},O=()=>{if(!L.isPay)return G(p("plan.premiumNotice"));n.emit("viewJSON")};return(t,e)=>{const s=x("vsc-tooltip"),j=x("router-view");return a(),r("div",null,[J(i("ul",Y,[(a(!0),r(N,null,F(A.value,(o,B)=>(a(),r("li",{key:B,class:_(["tab__item",{"tab__item--active":c.value==o.id,disabled:o.disabled?.()}]),onClick:ie=>k(o)},[o.icon?(a(),r("i",{key:0,type:"icon",class:_(o.icon),style:{position:"relative",top:"3px"}},null,2)):C("",!0),S(" "+w(d(p)(o.i18n)),1)],10,Z))),128)),b(s,{title:d(p)("table.editInVSCode")},{default:f(()=>[i("div",{class:"panel-icon !pl-2",style:{"border-left":"1px solid var(--border-color)"},onClick:M},e[1]||(e[1]=[i("img",{src:W,alt:"VSCode Logo"},null,-1)]))]),_:1},8,["title"]),b(s,{title:d(p)("table.viewAsJSON")},{default:f(()=>[i("div",{class:"panel-icon",onClick:O},e[2]||(e[2]=[i("i",{class:"codicon-json text-yellow"},null,-1)]))]),_:1},8,["title"]),b(s,{title:d(p)("table.history")},{default:f(()=>[i("div",{class:"panel-icon",onClick:e[0]||(e[0]=o=>d(n).emit("viewHistory"))},e[3]||(e[3]=[i("i",{class:"codicon-history"},null,-1)]))]),_:1},8,["title"]),u.value.database?(a(),r(N,{key:0},[i("div",{class:_(["panel-icon info ml-1 db-info-clickable",{loading:m.value}]),onClick:T},[e[4]||(e[4]=i("i",{class:"codicon-database blue mr-0.5 text-sm"},null,-1)),S(" "+w(u.value.database),1)],2),u.value.schema?(a(),r("div",{key:0,class:_(["panel-icon info db-info-clickable",{loading:m.value}]),onClick:T},[e[5]||(e[5]=i("i",{class:"codicon-symbol-structure yellow mr-0.5"},null,-1)),S(" "+w(u.value.schema),1)],2)):C("",!0)],64)):C("",!0)],512),[[U,d(y).showSQLPanel]]),b(j,null,{default:f(({Component:o})=>[b(H,null,{default:f(()=>[(a(),I(z,null,[(a(),I(Q(o)))],1024))]),_:2},1024)]),_:1})])}}}),me=K(ee,[["__scopeId","data-v-682ec2ae"]]);export{me as default};
